<!DOCTYPE html>
<html>
<head>
    @using LCL.MvcExtensions;
    @using UIShell.EasyUIAdminShellPlugin;
    @using UIShell.RbacPermissionService;
    @using LCL.MetaModel;
    <meta charset="UTF-8" />
    <!-- Title here -->
    <title>@LAppliction.Config.AppName</title>
    <!-- Description, Keywords and Author -->
    <meta name="keywords" content="MVC,EasyUI,LCL,DDD,Domain,Services,Specifications,Events" />
    <meta name="description" content="ASP.NET MVC+EasyUI+LCL+插件构建的企业信息化快速开发框架,LCLFramework就是一套在.NET下支持面向领域驱动的软件系统管理类软件的快速开发框架" />
    <meta name="author" content="Luomg" />
    <meta name="copyright" content="All Rights Reserved, Copyright (C) 2015, luomg, Ltd." />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="@(Url.BundleContent(BundleActivator.Bundle, "Content/JQueryEasyUI/themes/default/easyui.css"))" />
    <link rel="stylesheet" type="text/css" href="@(Url.BundleContent(BundleActivator.Bundle, "Content/JQueryEasyUI/themes/icon.css"))" />
    <link rel="stylesheet" type="text/css" href="@(Url.BundleContent(BundleActivator.Bundle, "Content/easyuiDefault.css"))" />
    <link rel="stylesheet" type="text/css" href="@(Url.BundleContent(BundleActivator.Bundle, "Content/icons.css"))" />
    <script src="@(Url.BundleContent(BundleActivator.Bundle, "Scripts/jquery-1.8.0.min.js"))"></script>
    <script src="@(Url.BundleContent(BundleActivator.Bundle, "Content/JQueryEasyUI/jquery.min.js"))"></script>
    <script src="@(Url.BundleContent(BundleActivator.Bundle, "Content/JQueryEasyUI/jquery.easyui.min.js"))"></script>
    <script src="@(Url.BundleContent(BundleActivator.Bundle, "Content/JQueryEasyUI/locale/easyui-lang-zh_CN.js"))" charset="utf-8"></script>
    <script src="@(Url.BundleContent(BundleActivator.Bundle, "Scripts/outlook2.js"))"></script>
    <!-- Favicon -->
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <script type="text/javascript">
        $(function () {
            //绑定菜单单击事件
            BindMenuClickHrefEvent();
            //读取动态时间的变化
            ReadDateTimeShow();
            //这里实现对时间动态的变化
            var setTimeInterval = setInterval(ReadDateTimeShow, 1000);
            $("#tabs").contextMenus();

            $('#editpass').click(function () {
                openPwd();
                $('#w').window('open');
            });
            $('#btnEp').click(function () {
                serverLogin();
            })
            $('#btnCancel').click(function () { closePwd(); })
            $('#loginOut').click(function () {
                $.messager.confirm('系统提示', '您确定要退出本次登录吗?', function (r) {
                    if (r) {
                        location.href = 'Logout';
                    }
                });
            })
        });
        //实现用户单击导航栏跳转页面的方法
        function BindMenuClickHrefEvent() {

            $(".menulink").bind("click", function () {
                var title = trim($(this).text());
                var url = $(this).attr('rel');
                var iconCls = $(this).attr('iconcss');
                var iframe = $(this).attr('iframe') == 1 ? true : false;
                addTab(title, url, iconCls, iframe);
            });
        }
        //设置登录窗口
        function openPwd() {
            $('#w').window({
                title: '修改密码',
                width: 400,
                height: 180,
                modal: true,
                shadow: false,
                closed: true,
                resizable: false,
                minimizable: false,
                maximizable: false,
                collapsible: false
            });
        }
        //关闭登录窗口
        function closePwd() {
            $('#w').window('close');
        }
        //修改密码
        function serverLogin() {
            var $newpass = $('#txtNewPass');
            var $rePass = $('#txtRePass');

            if ($newpass.val() == '') {
                msgShow('系统提示', '请输入密码！', 'warning');
                return false;
            }
            if ($rePass.val() == '') {
                msgShow('系统提示', '请在一次输入密码！', 'warning');
                return false;
            }

            if ($newpass.val() != $rePass.val()) {
                msgShow('系统提示', '两次密码不一至！请重新输入', 'warning');
                return false;
            }

            $.post('/ajax/editpassword.ashx?newpass=' + $newpass.val(), function (msg) {
                msgShow('系统提示', '恭喜，密码修改成功！<br>您的新密码为：' + msg, 'info');
                $newpass.val('');
                $rePass.val('');
                close();
            })

        }
    </script>
</head>

<body style="overflow: hidden; overflow-y: hidden; overflow-x: hidden;" scrolling="no" class="easyui-layout" fit="true">
    <noscript>
        <div style=" position:absolute; z-index:100000; height:2046px;top:0px;left:0px; width:100%; background:white; text-align:center;">
            <img src="@(Url.BundleContent(BundleActivator.Bundle, "Content/images/noscript.gif"))" alt='抱歉，请开启脚本支持！' />
        </div>
    </noscript>
    <div id="loading-mask" style="position:absolute;top:0px; left:0px; width:100%; height:100%; background:#D2E0F2; z-index:20000">
        <div id="pageloading" style="position:absolute; top:50%; left:50%; margin:-120px 0px 0px -120px;
text-align:center;  border:2px solid #8DB2E3; width:200px; height:40px;  font-size:14px;padding:10px;
font-weight:bold; background:#fff; color:#15428B;">
            正在加载中,请稍候...
        </div>
    </div>
    <!-- head begin -->
    <div data-options="region:'north'" style="overflow: hidden;height:55px;">
        <div class="index_top_box">
            <h1>
                @LAppliction.Config.AppName
            </h1>
            <div class="index_top_box_rt">
                <span id="bgclock"></span>
                <span>
                    <a id="btnUser" href="#">@LCL.LEnvironment.Principal.Identity.Name 用户您好！欢迎进入</a>
                    |&nbsp;&nbsp;<a href="#" id="editpass">修改密码</a>
                    |&nbsp;&nbsp;<a href="#" title="将反馈建议提交给开发商进行解决" onclick="window.open('http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=GnZvdXdzdH1vc1prazR5dXc', '_blank')">反馈建议</a>
                    |&nbsp;&nbsp;<a href="#" id="loginOut"><b>退出</b>&nbsp;&nbsp;</a>
                </span>
            </div>
        </div>
    </div>
    <!-- head end -->
    <!-- left begin -->
    <div data-options="iconCls:'icon-home',region:'west',split:true" title=" 操作平台 " style="width: 200px; padding: 1px; overflow: hidden;">
        <div id="leftmenu" class="easyui-accordion left-Accordion" data-options="animate:false,fit:true,border:false">
            @for (int i = 0; i < CommonModel.Modules.Roots.Count; i++)
            {
                var node = CommonModel.Modules.Roots[i];
                string divdataoption = "false";
                if (i == 0)
                {
                    divdataoption = "true";
                }
                <div title="@node.Label" data-options='iconCls:"@node.Image",selected:@divdataoption' style="overflow: auto; padding: 10px;">
                    @for (int j = 0; j < node.Children.Count; j++)
                    {
                        var child = node.Children[j];
                        <ul class="zyl_left">
                            <li>
                                <div>
                                    <a href="javascript:void(@j)" rel="@Url.Content(child.CustomUI)" class="menulink" iconcss="@child.Image" iframe="0">
                                        <span id="iconCss" class="@child.Image" iconcss="@child.Image">&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                        <span class="nav">&nbsp;@child.Label</span>
                                    </a>
                                </div>
                            </li>
                        </ul>
                    }
                </div>
            }
        </div>
    </div>
    <!-- left end -->
    <!-- center begin -->
    <div id="mainPanle" data-options="region:'center'" style="background: #eee; overflow-y: hidden">
        <div id="tabs" class="easyui-tabs" fit="true">

            <div title="欢迎使用" data-options="closable:false,iconCls:'icon-tip',cls:'pd3'" style="padding:20px;overflow:hidden; color:red; ">
                <h1 style="font-size:24px;">* 作者：罗敏贵 QQ：271391233</h1>
                <h1 style="font-size:24px;">* BLOG: <a style="font-size:24px;color:green;" href="http://luomingui.cnblogs.com" target="_blank">博客</a></h1>
                <h1 style="font-size:24px;">* 讨论群：34178394</h1>
                <h1 style="font-size:24px;">* 广告：本人承接各类大中小型管理系统的软件的设计与开发，有需要的朋友联系我啦~~~~</h1>
            </div>

        </div>
    </div>
    <!-- center end -->
    <!-- foot begin -->
    <div data-options="region:'south',split:true" title="" style="height: 30px; background: #eee;">
        <div style="text-align: center; padding: 2px;">
            <span>&copy; 2015 </span><span><a href="http://luomingui.cnblogs.com/" target="_blank">@LAppliction.Config.CompanyName</a></span>
            <span><a href="#">联系我们</a></span>&nbsp;&nbsp; 当前时间：<b id="date"></b>
        </div>
    </div>
    <!-- foot end -->
    <!--修改密码窗口-->
    <div id="w" class="easyui-window" title="修改密码" collapsible="false" minimizable="false"
         maximizable="false" iconcls="icon-edit" style="width: 400px; height: 180px; padding: 5px;
        background: #fafafa;" closed="true">
        <div class="easyui-layout" fit="true">
            <div region="center" border="false" style="padding: 10px; background: #fff; border: 1px solid #ccc;">
                <table class="tb_searchbar" cellpadding=3>
                    <tr>
                        <td class="td_title">新密码：</td>
                        <td><input id="txtNewPass" type="Password" class="txt01" /></td>
                    </tr>
                    <tr>
                        <td class="td_title">确认密码：</td>
                        <td><input id="txtRePass" type="Password" class="txt01" /></td>
                    </tr>
                </table>
            </div>
            <div region="south" border="false" style="text-align: right;">
                <a id="btnEp" class="easyui-linkbutton" icon="icon-ok" href="javascript:void(0)">
                    确定
                </a> <a id="btnCancel" class="easyui-linkbutton" icon="icon-cancel" href="javascript:void(0)">取消</a>
            </div>
        </div>
    </div>

    @*<script src="@(Url.BundleContent(BundleActivator.Bundle, "Scripts/include_script.js"))"></script>
        <script src="@(Url.BundleContent(BundleActivator.Bundle, "Scripts/killie.js"))"></script>
        <script src="@(Url.BundleContent(BundleActivator.Bundle, "Scripts/SetSafe.js"))"></script>*@    
</body>
</html>